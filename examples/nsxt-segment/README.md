# VMWare NSX-T VM Network Segement Example
This Terraform configures a VM network segement in VMware NSX-T with optional DHCP configuration.

# Execution environment
This Terraform must be executed from a system with access to the NSX-T endpoint. This cannot be Cloud Shell. Therefore
the system from which this Terraform is run from must have the following pre-requisites:
- Reachability to NSX-T Endpoint
- Google cloud SDK (glcoud)
- Terraform 1.x

# Terraform Configuration
Configuration is passed to the terraform module in the form of a yaml file named `config.yaml`. Details of the configuration file parameters are in the [module README file](../README.md)

## Terraform Configuration Variables
| Variable  | Description | Type |
| ---      |  ------  |----------|
| `nsxt_url` | The http endpoint of NSX-T | `string` |
| `nsxt_user` | A user with admin permissions on NSX-T. | `string` |
| `nsxt_password` | The `nsxt_user` password. | `string` |

# Setting up credentials
The NSX-T API requires user & password authentication. These can be fetched from the GCVE console. These credentials need to be passed at Terraform variables at runtime either on the command line (preferred) with the `-var` option or in a `.tfvars` file

# Running Terraform
The following command will initialize Terraform:
```
terraform init
```
Next, Terraform need to *plan* the creation of the required resources, which is achieved by running:
```
terraform plan -var="nsx_url=<NSX_URL>" -var="nsx_user=<NSX_USER>" -var="nsx_password=<NSX_PASSWORD>" -out tf.out
```
The result of the plan will be saved to file `tf.out`.

To execute the changes, Terraform needs to *apply* the plan, which is achieved by running:
```
terraform apply tf.out
```
The resources will be created.

