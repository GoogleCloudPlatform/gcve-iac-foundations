/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

variable "nsxt_url" {
  type        = string
  description = "The URL of the NSX-T endpoint"
}

variable "nsxt_user" {
  type        = string
  description = "The username used to connect to the NSX-T endpoint. Must be an admin user"
  sensitive   = true
}

variable "nsxt_password" {
  type        = string
  description = "The password for the NSX-T user"
  sensitive   = true
}

variable "policy_name" {
  description = "The name for the new firewall policy"
  type        = string
  default     = "vm_firewall"
}

variable "custom_l4_services" {
  description = <<EOT
A map of objects which is used to define custom TCP/UDP services which can be
added to firewall rules. Service objects allow all properties in the Terraform
[nsxt_policy_service l4_port_set_entry object]
(https://registry.terraform.io/providers/vmware/nsxt/latest/docs/resources/policy_service#l4_port_set_entry)
EOT
  type = map(object({
    description       = string
    protocol          = optional(string)
    destination_ports = optional(list(number))
    source_ports      = optional(list(number))
    tags              = optional(map(string))
  }))
  default = {}
}

variable "rules" {
  description = "A list of objects which describe firewall rules. Rule objects allow all properties in the Terraform nsxt_policy_gateway_policy rule object."
  type = list(object({
    display_name          = string
    description           = optional(string)
    disabled              = optional(bool)
    action                = optional(string)
    direction             = optional(string)
    logged                = optional(bool)
    services              = optional(list(string))
    destination_groups    = optional(list(string))
    destinations_excluded = optional(bool)
    source_groups         = optional(list(string))
    sources_excluded      = optional(bool)
    tags                  = optional(map(string))
  }))
  default = []
}