# GCVE Service Networking Module

This module contains the terraform to create and deploy a GCVE Service Networking 

<!-- BEGIN_AUTOMATED_TF_DOCS_BLOCK -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.5.3 |
| <a name="requirement_google"></a> [google](#requirement\_google) | >= 4.35.0 |
| <a name="requirement_google-beta"></a> [google-beta](#requirement\_google-beta) | >= 4.71.0 |

## Usage
Basic usage of this module is as follows:

```hcl
module "example" {
	 source  = "github.com/GoogleCloudPlatform/gcve-iac-foundations//modules/gcve-service-networking"

	 # Required variables
	 project_id  = "<PROJECT_ID>"
	 region  = "<REGION>"
	 network_name  = "<GCP_NETWORK_NAME>"
	 pc_location  = "<PRIVATE_CONNECTION_LOCATION>"
	 create_gcve_network  = "<CREATE_GCVE_NETWORK>"
	 gcve_connection_name  = "<GCVE_CONNECTION_NAME>"
	 gcve_network_location  = "<GCVE_NETWORK_LOCATION>"
	 gcve_network_name  = "<GCVE_NETWORK_NAME>"
	 primary_private_ip_alloc  = "<PRIMARY_PRIVATE_IP_ALLOC_NAME>"
	 private_ip_allocation_details  = "<PRIVATE_IP_ALLOC_DETAILS>"

	 # Optional variables
	 address_purpose  = "VPC_PEERING"
	 address_type  = "INTERNAL"
	 auto_create_subnetworks  = false
	 create_network  = true
	 delete_default_internet_gateway_routes  = false
	 gcve_network_description  = ""
	 gcve_network_type  = "LEGACY"
	 mtu  = 0
	 network_description  = ""
	 pc_connection_type  = "PRIVATE_SERVICE_ACCESS"
	 pc_description  = "gcve_service_networking"
	 pc_routing_mode  = "GLOBAL"
	 peering  = "servicenetworking-googleapis-com"
	 routing_mode  = "GLOBAL"
	 secondary_ranges  = {}
	 service  = "servicenetworking.googleapis.com"
	 subnets  = []
}
```

## Resources

| Name | Type |
|------|------|
| [google-beta_google_vmwareengine_network.gcve_network](https://registry.terraform.io/providers/hashicorp/google-beta/latest/docs/resources/google_vmwareengine_network) | resource |
| [google_compute_global_address.private_ip_alloc](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_global_address) | resource |
| [google_compute_network.network](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_network) | resource |
| [google_compute_network_peering_routes_config.peering_routes](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_network_peering_routes_config) | resource |
| [google_compute_subnetwork.subnetwork](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork) | resource |
| [google_service_networking_connection.gcve_psa](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/service_networking_connection) | resource |
| [google-beta_google_vmwareengine_network.gcve_network](https://registry.terraform.io/providers/hashicorp/google-beta/latest/docs/data-sources/google_vmwareengine_network) | data source |
| [google_compute_network.network](https://registry.terraform.io/providers/hashicorp/google/latest/docs/data-sources/compute_network) | data source |
| [google_compute_network_peering.servicenetworking](https://registry.terraform.io/providers/hashicorp/google/latest/docs/data-sources/compute_network_peering) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_address_purpose"></a> [address\_purpose](#input\_address\_purpose) | Purpose value to use in google\_compute\_global\_address resource | `string` | `"VPC_PEERING"` | no |
| <a name="input_address_type"></a> [address\_type](#input\_address\_type) | Address type value to use in google\_compute\_global\_address resource | `string` | `"INTERNAL"` | no |
| <a name="input_auto_create_subnetworks"></a> [auto\_create\_subnetworks](#input\_auto\_create\_subnetworks) | When set to true, the network is created in 'auto subnet mode' and it will create a subnet for each region automatically across the 10.128.0.0/9 address range. When set to false, the network is created in 'custom subnet mode' so the user can explicitly connect subnetwork resources. | `bool` | `false` | no |
| <a name="input_create_gcve_network"></a> [create\_gcve\_network](#input\_create\_gcve\_network) | Set to true to create google vmwareengine network | `bool` | n/a | yes |
| <a name="input_create_network"></a> [create\_network](#input\_create\_network) | If set to true, new VPC will be created | `bool` | `true` | no |
| <a name="input_delete_default_internet_gateway_routes"></a> [delete\_default\_internet\_gateway\_routes](#input\_delete\_default\_internet\_gateway\_routes) | If set, ensure that all routes within the network specified whose names begin with 'default-route' and with a next hop of 'default-internet-gateway' are deleted | `bool` | `false` | no |
| <a name="input_gcve_connection_name"></a> [gcve\_connection\_name](#input\_gcve\_connection\_name) | the GCVE Private Connection ID | `string` | n/a | yes |
| <a name="input_gcve_network_description"></a> [gcve\_network\_description](#input\_gcve\_network\_description) | Description for the VMware Engine network | `string` | `""` | no |
| <a name="input_gcve_network_location"></a> [gcve\_network\_location](#input\_gcve\_network\_location) | The location where the VMwareEngineNetwork should reside | `string` | n/a | yes |
| <a name="input_gcve_network_name"></a> [gcve\_network\_name](#input\_gcve\_network\_name) | The ID of the VMware Engine Network | `string` | n/a | yes |
| <a name="input_gcve_network_type"></a> [gcve\_network\_type](#input\_gcve\_network\_type) | VMware Engine network type | `string` | `"LEGACY"` | no |
| <a name="input_mtu"></a> [mtu](#input\_mtu) | The network MTU (If set to 0, meaning MTU is unset - defaults to '1460'). Recommended values: 1460 (default for historic reasons), 1500 (Internet default), or 8896 (for Jumbo packets). Allowed are all values in the range 1300 to 8896, inclusively. | `number` | `0` | no |
| <a name="input_network_description"></a> [network\_description](#input\_network\_description) | Description for the GCP Network | `string` | `""` | no |
| <a name="input_network_name"></a> [network\_name](#input\_network\_name) | The name of the network being created | `string` | n/a | yes |
| <a name="input_pc_connection_type"></a> [pc\_connection\_type](#input\_pc\_connection\_type) | Connection Type for GCVE Private Connection | `string` | `"PRIVATE_SERVICE_ACCESS"` | no |
| <a name="input_pc_description"></a> [pc\_description](#input\_pc\_description) | Description for the Private Connection | `string` | `"gcve_service_networking"` | no |
| <a name="input_pc_location"></a> [pc\_location](#input\_pc\_location) | The region to create the private connection | `string` | n/a | yes |
| <a name="input_pc_routing_mode"></a> [pc\_routing\_mode](#input\_pc\_routing\_mode) | The routing mode of Private Connection | `string` | `"GLOBAL"` | no |
| <a name="input_peering"></a> [peering](#input\_peering) | Peering value to use in google\_compute\_network\_peering\_routes\_config resource | `string` | `"servicenetworking-googleapis-com"` | no |
| <a name="input_primary_private_ip_alloc"></a> [primary\_private\_ip\_alloc](#input\_primary\_private\_ip\_alloc) | Primary Private IP Allocation which can be used for GCVE PSA Connection | `string` | n/a | yes |
| <a name="input_private_ip_allocation_details"></a> [private\_ip\_allocation\_details](#input\_private\_ip\_allocation\_details) | Private IP Allocation details to Create Compute Global Address | <pre>map(object({<br>    name          = string,<br>    address       = string,<br>    prefix_length = number<br>  }))</pre> | n/a | yes |
| <a name="input_project_id"></a> [project\_id](#input\_project\_id) | Project to create GCVE Service networking Resources | `string` | n/a | yes |
| <a name="input_region"></a> [region](#input\_region) | The region to use | `string` | n/a | yes |
| <a name="input_routing_mode"></a> [routing\_mode](#input\_routing\_mode) | The network routing mode (default 'GLOBAL') | `string` | `"GLOBAL"` | no |
| <a name="input_secondary_ranges"></a> [secondary\_ranges](#input\_secondary\_ranges) | Secondary ranges that will be used in some of the subnets | `map(list(object({ range_name = string, ip_cidr_range = string })))` | `{}` | no |
| <a name="input_service"></a> [service](#input\_service) | Service value to use in google\_service\_networking\_connection resource | `string` | `"servicenetworking.googleapis.com"` | no |
| <a name="input_subnets"></a> [subnets](#input\_subnets) | The list of subnets being created | `list(map(string))` | `[]` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_gcve_network_details"></a> [gcve\_network\_details](#output\_gcve\_network\_details) | GCVE Network Details |
| <a name="output_gcve_network_name"></a> [gcve\_network\_name](#output\_gcve\_network\_name) | GCVE Network Name |
| <a name="output_gcve_service_network_connection"></a> [gcve\_service\_network\_connection](#output\_gcve\_service\_network\_connection) | GCVE Service Network Connection |
| <a name="output_network_id"></a> [network\_id](#output\_network\_id) | The ID of the VPC being created |
| <a name="output_network_name"></a> [network\_name](#output\_network\_name) | The name of the VPC being created |
| <a name="output_network_self_link"></a> [network\_self\_link](#output\_network\_self\_link) | The URI of the VPC being created |
| <a name="output_peer_network_project_id"></a> [peer\_network\_project\_id](#output\_peer\_network\_project\_id) | Peer Network Project ID |
| <a name="output_peering_route_config"></a> [peering\_route\_config](#output\_peering\_route\_config) | Peering Route Config |
| <a name="output_private_ip_alloc_addresses"></a> [private\_ip\_alloc\_addresses](#output\_private\_ip\_alloc\_addresses) | Address of Private IP Allocations used for Peering |
| <a name="output_private_ip_alloc_details"></a> [private\_ip\_alloc\_details](#output\_private\_ip\_alloc\_details) | Names of Private IP Allocations for Peering |
| <a name="output_private_ip_alloc_ids"></a> [private\_ip\_alloc\_ids](#output\_private\_ip\_alloc\_ids) | ID of Private IP Allocations used for Peering |
| <a name="output_private_ip_alloc_names"></a> [private\_ip\_alloc\_names](#output\_private\_ip\_alloc\_names) | Names of Private IP Allocations used for Peering |
| <a name="output_private_ip_alloc_self_link"></a> [private\_ip\_alloc\_self\_link](#output\_private\_ip\_alloc\_self\_link) | Self Link of Private IP Allocations used for Peering |
| <a name="output_subnets"></a> [subnets](#output\_subnets) | The created subnet resources |

<!-- END_AUTOMATED_TF_DOCS_BLOCK -->